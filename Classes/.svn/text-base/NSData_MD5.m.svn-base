
#import "NSData_MD5.h"
#import <CommonCrypto/CommonDigest.h>

@implementation NSData (NSData_MD5)

- (NSString *)md5 {
    unsigned char digest[16];
    char finaldigest[32];
    int i;
    
    CC_MD5([self bytes],[self length],digest);
    for(i=0;i<16;i++) sprintf(finaldigest+i*2,"%02x",digest[i]);
    
    return [NSString stringWithCString:finaldigest length:32];
}

@end

@implementation NSString (NSData_MD5)

- (NSString *)md5 {
    return [[self dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:NO] md5];
}

@end

